create database 회사DB;
use 회사DB;

create table Department (
	DeptNo int not null,
	DeptName char(10),
	Floor int,
	primary key (DeptNo)
);

insert into Department values (1, '영업', 8);
insert into Department values (2, '기획', 10);
insert into Department values (3, '개발', 9);
insert into Department values (4, '총무', 7);

Select *
From Department;

create table Employee (
	EmpNo int not null,
	EmpName char(10),
	Title char(10),
	Manager int,
	Salary int,
	Dno int,
	primary key (EmpNo),
	foreign key (Dno) references Department (DeptNo),
	foreign key (Manager) references Employee (EmpNo)
);

insert into Employee values (4377, '이성래', '사장', null, 5000000, 2);
insert into Employee values (3426, '박영권', '과장', 4377, 3000000, 1);
insert into Employee values (3011, '이수민', '부장', 4377, 4000000, 3);
insert into Employee values (1003, '조민희', '과장', 4377, 3000000, 2);
insert into Employee values (2106, '김창섭', '대리', 1003, 2500000, 2);
insert into Employee values (3427, '최종철', '사원', 3011, 1500000, 3);
insert into Employee values (1365, '김상원', '사원', 3426, 1500000, 1);

Select *
From Employee;

-- 김창섭이 근무하는 부서번호?
Select EmpName, Dno
From Employee
Where EmpName = '김창섭';

-- 김창섭이 근무하는 부서이름?
Select EmpName, DeptName
From Employee, Department
Where Employee.Dno = Department.DeptNo and EmpName = '김창섭';

-- 1번 부서에서 근무하는 직원들의 이름?
Select EmpName
From Employee
Where Dno = 1;

-- 영업 부서에 근무하는 직원들의 이름과 직책?
Select EmpName, Title
From Employee, Department
Where Employee.Dno = Department.DeptNo and DeptName = '영업';

-- 모든 직원의 이름과 근무 부서명?
Select EmpName, DeptName
From Employee, Department
Where Employee.Dno = Department.DeptNo

-- 과장인 직원들의 이름과 직책, 근무 부서명?
Select EmpName, Title, DeptName
From Employee, Department
Where Employee.Dno = Department.DeptNo and Title = '과장';

-- 9층에 근무하는 직원들의 이름과 급여, 근무 부서명?
Select EmpName, Salary, DeptName
From Employee,Department
Where Employee.Dno = Department.DeptNo and Floor = 9;